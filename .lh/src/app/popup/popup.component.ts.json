{
    "sourceFile": "src/app/popup/popup.component.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1733042357823,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1733043120873,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -37,9 +37,9 @@\n     \r\n     console.log(this.data.name)\r\n     this.updateForm = this.formBuilder.group({\r\n       status: ['', Validators.required],\r\n-      AdditionalNotes: ['',],\r\n+      AdditionalNotes: [''],\r\n       ApprovedBy: [this.data.name]\r\n     })\r\n \r\n     this.generateRequest = this.formBuilder.group({\r\n@@ -82,8 +82,9 @@\n         }, error => {\r\n           console.log(error)\r\n         }\r\n       )\r\n+      \r\n \r\n     }else{\r\n       this.formValid = true;\r\n     }\r\n"
                },
                {
                    "date": 1733043126095,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,9 +83,9 @@\n           console.log(error)\r\n         }\r\n       )\r\n \r\n-      this.apiService.creat\r\n+      this.apiService.create\r\n \r\n     }else{\r\n       this.formValid = true;\r\n     }\r\n"
                },
                {
                    "date": 1733043138537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,9 +82,9 @@\n         }, error => {\r\n           console.log(error)\r\n         }\r\n       )\r\n-      co\r\n+      con\r\n \r\n       // this.apiService.createPosRequest()\r\n \r\n     }else{\r\n"
                }
            ],
            "date": 1733042357823,
            "name": "Commit-0",
            "content": "import { Component, Inject, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\r\nimport { AppService } from '../app.service';\r\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { ApiDetailsService } from '../api-details.service';\r\nimport { Users } from '../users';\r\n\r\n@Component({\r\n  selector: 'app-popup',\r\n  templateUrl: './popup.component.html',\r\n  styleUrl: './popup.component.css'\r\n})\r\nexport class PopupComponent implements OnInit {\r\n\r\n  updateForm: FormGroup = new FormGroup({});\r\n  formValid = false;\r\n  generateRequest: FormGroup = new FormGroup({});\r\n  updateRequest: FormGroup = new FormGroup({});\r\n  requestID = this.data.tabs[0].items[0].value;\r\n  user: any;\r\n  userDetails: Users[] = [];\r\n  selectedOfficerLocation: string = '';\r\n  deployRequest: FormGroup = new FormGroup({});\r\n  \r\n\r\n  constructor(\r\n    private popupRef: MatDialogRef<PopupComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    private apiService: ApiDetailsService,\r\n    private formBuilder: FormBuilder,\r\n    private sharedService: AppService\r\n  ){}\r\n\r\n  ngOnInit(): void {\r\n    this.user = this.sharedService.getUser();\r\n    console.log(this.user);\r\n    \r\n    console.log(this.data.name)\r\n    this.updateForm = this.formBuilder.group({\r\n      status: ['', Validators.required],\r\n      AdditionalNotes: ['',],\r\n      ApprovedBy: [this.data.name]\r\n    })\r\n\r\n    this.generateRequest = this.formBuilder.group({\r\n      Pos_RequestId: [this.requestID],\r\n      Pos_Accounts: ['', Validators.required],\r\n      PTSP: ['', Validators.required],\r\n      Pos_Model: ['', Validators.required],\r\n      Pos_Processor: ['', Validators.required],\r\n      status: ['Approved']\r\n    })\r\n    \r\n    this.updateRequest = this.formBuilder.group({\r\n      status: ['in_process'],\r\n      ApprovedBy: [this.data.name],\r\n    ApprovedBy2: [this.user.user.firstname +' ' + this.user.user.surname]\r\n    })\r\n\r\n    this.deployRequest = this.formBuilder.group({\r\n      name: ['', Validators.required],\r\n      location: ['']\r\n    })\r\n\r\n    this.apiService.getAllUsers().subscribe( data => {\r\n      this.userDetails = data.filter((user: any) => user.jobPosition === 'POS Officer').map((user: any) => ({\r\n        location: user.Location,\r\n        name: user.firstname + ' ' + user.surname\r\n      }));\r\n      console.log(this.userDetails)\r\n    })\r\n  }\r\n\r\n  updateProcess(){\r\n    if (this.updateForm.valid){\r\n      console.log(this.updateForm.value)\r\n\r\n      this.apiService.updateRequest(this.requestID, this.updateForm.value).subscribe(\r\n        data => {\r\n          console.log(data);\r\n          this.popupRef.close();\r\n        }, error => {\r\n          console.log(error)\r\n        }\r\n      )\r\n\r\n    }else{\r\n      this.formValid = true;\r\n    }\r\n\r\n  }\r\n\r\n  generateSN(){\r\n    console.log(this.requestID)\r\n    if (this.generateRequest.valid)\r\n    {\r\n      console.log(this.generateRequest.value)\r\n      this.apiService.generateSN(this.requestID, this.generateRequest.value).subscribe(\r\n        data => {\r\n          console.log(data);\r\n          this.popupRef.close();\r\n        }, error => {\r\n          console.log(error)\r\n        }\r\n      )\r\n      this.apiService.updateRequest(this.requestID, this.updateRequest.value).subscribe(\r\n        result => {\r\n          console.log(result);\r\n        }, error => {\r\n          console.log(error)\r\n        }\r\n      );\r\n    }\r\n    else{\r\n      console.log(this.generateRequest.errors)\r\n    }\r\n  }\r\n\r\n  \r\n  selectedOfficer(){\r\n    const officer = this.userDetails.find(\r\n      user => user['name'] === this.deployRequest.get('name')?.value\r\n    )\r\n    if(officer ){\r\n      console.log('Officer Name: '+this.deployRequest.get('name')?.value)\r\n      this.selectedOfficerLocation = officer['location'];\r\n      if(this.selectedOfficerLocation === null)\r\n        {\r\n          this.selectedOfficerLocation = 'No Location'\r\n        }\r\n      console.log('Location: ' + this.selectedOfficerLocation)\r\n    }\r\n  }\r\n\r\n}\r\n"
        }
    ]
}